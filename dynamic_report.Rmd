---
title: My dynamic report
output: html_fragment
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)
library(tidyverse)

```

```{css echo=FALSE}

```

## What's going on with this data?

You need to change the contents of this Rmd! Replace the R code and markdown give below in this template document.

```{r}
logged_data <- read_csv('project2_responses.csv')

#renaming variable
logged_data <- rename(logged_data, grade =  "What was the grade of the climb?",
                      attempts = "How many attempts did you take",
                      top = "Topped?",
                      colour = "What was the colour of the climb?")

#convert v grades into numbers
logged_data$grade_numbers <- as.numeric(gsub("V", "", logged_data$grade)) 

#rearranging table
logged_data <- logged_data[,c("Timestamp", "grade", "grade_numbers", "attempts", "top", "colour")]

colour_count <- table(logged_data$colour)

median_grade <- median(logged_data$grade_numbers)

mean_attempts_topped <- mean(logged_data$attempts[logged_data$top == "Yes"])

min(logged_data$grade_numbers)
max(logged_data$grade_numbers)

min(logged_data$attempts)
max(logged_data$attempts)

sucess_count <- sum(logged_data$top == "Yes")
total_climbs <- length(logged_data$top)

sucess_rate <- (sucess_count / total_climbs) * 100

grade_attempts <- aggregate(logged_data$attempts ~ logged_data$grade, FUN = mean)

#bar graphs
logged_data %>%
  ggplot() + 
    geom_bar(aes(x=colour))
  
logged_data %>%
  ggplot() + 
  geom_bar(aes(x=grade_numbers))

logged_data %>%
  ggplot() + 
  geom_bar(aes(x=top, fill = top))

```

The best pet to have is a `r best_pet` of course!

![](https://c.tenor.com/-qBsG1HwR4oAAAAC/tenor.gif)
